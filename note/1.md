

### 1、基本安装使用
webpack4 开始 `webpack` 和 `webpack-cli` 分开为两个包
```sh
npm install webpack webpack-cli --save-dev
```
极简例子
```js webpack.config.js
const path = require('path')
module.exports = {
  entry: './src/index.js',
  output: {
    path: path.join(__dirname, 'dist'),
    filename: 'bundle.js'
  },
  mode:'production'
}
```
```json package.json
"scripts": {
  "test": "echo \"Error: no test specified\" && exit 1",
  "build": "webpack"
},
```
### 2、entry 使用
单入口
```js
module.exports = {
  entry:'./src/index.js'
}
```
多入口
```js
module.exports = {
  entry:{
    app:'./src/app.js',
    appAdmin:'./src/appAdmin.js',
  }
}
```
[更详细内容](https://www.webpackjs.com/configuration/entry-context/#entry)

### output 使用
与 `entry` 相对应，出口文件路径。`output` 并没有单文件和多文件之分，采用了占位符来确保文件名称唯一.

### loader 概念及使用
`webpack` 自带只支持 `js` 和 `json` 两种文件，通过 loader 俩支持其他文件转换为有效的代码并添加到依赖图中。

本身是一个函数，接受源代码作为参数，返回转换后的结果。


#### 常用 loader

名称                       | 描述
--------------------------|-------------------------
babel-loader              |转换 ES6、ES7 等js新特性语法支持
css-loader                |支持 css 文件的加载和解析
less-loader               |将 less 文件转换为 css
ts-loader                 |将 TS 转换为 js
file-loader               |进行图片、字体等的打包
raw-loader                |将文件以字符串形式导入
thread-loader             |多进程打包 js 和 css

[更多loader查看](https://www.webpackjs.com/loaders/)   
[loader使用规则](https://www.webpackjs.com/concepts/loaders/#%E7%A4%BA%E4%BE%8B)


### plugins 概念及使用规则
用于将 bundle 文件优化，资源管理以及环境变量注入。用于整个构建过程。

#### 常用 plugins 

名称                       | 描述
--------------------------|-------------------------
CommonsChunkPlugin        |提取 chunks 之间共享的通用模块
CleanWebpackPOlugin       |清理构建目录
ExtractTextWebpackPlugin  |从 bundle 中提取文本（CSS）到单独的文件
CopyWebpackPlugin         |将单个文件或整个目录复制到构建目录
HtmlWebpackPlugin         |简单创建 HTML 文件，用于服务器访问
UglifyjsWebpackPlugin     |压缩js
ZipWebpackPlugin          |将打包出来的资源生成一个zip包
[更多plugins](https://www.webpackjs.com/plugins/)   
[使用规则](https://www.webpackjs.com/concepts/plugins/)


### mode 概念
mode用来指定当前的构建环境分别为: production、development、node。

**设置mode可以使用webpack内置的函数，默认值为 production。**

**mode 的内置函数功能**

名称                       | 描述
--------------------------|-------------------------
development               |设置 process.env.NODE_ENV 的值为 development。 开启 NamedChunksPlugin 和 NamedmodulesPlugin 
production                |设置 process.env.NODE_ENV 的值为 production。开启 FlagDependencyUsagePlugin,FlagIncludedChunksPlugin,ModuleConcatenationPlugin,NoEmitOnErrorsPlugin,OccurrenceOrderPlugin,SideEffectsFlagPlugins 和 TerserPlugin
none                      |不开启任何优化选项

### 一个极简的例子

```shell
npm install @babel/core @babel/preset-env -D
```

```js  webpack.config.js
const path = require('path')
module.exports = {
  entry: {
    index:'./src/index.js',
    search:'./src/serarch.js'
  },
  module:{
    rules:[
      {
        test:/\.js$/,
        use:'babel-loader'
      }
    ]
  },
  output: {
    path: path.join(__dirname, 'dist'),
    filename: '[name].js'
  },
  mode:'production'
}
```
```js .babelrc
{
  "presets": [
    "@babel/preset-env",
    "@babel/preset-react"
  ]
}
```






### 解析 css
css-loader 用于加载 .css 文件，并且转换成 commonjs 对象。    
style-loader 将样式通过 `<style>` 标签插入到 head 中。

```shell
npm install css-loader style-loader sass-loader node-sass -D
```

```js webpack.config.js
const path = require('path')
module.exports = {
 // some code ...
  module:{
    rules:[
      // somde code ...
      {
        test:/\.css$/,
        use:[
          'style-loader',
          'css-loader',
          'sass-loader'
        ]
      }
    ]
  },
}

```
loader 的调用是链式调用的，执行顺序是从右到左的，因此所有 loader 的组合调用，应该是先调用的写在最后面。

### 资源解析：解析图片
```shell
npm install file-loader -D
```
```js webpack.config.js
module.exports = {
 // some code ...
  module:{
    rules:[
      // somde code ...
      {
        test: /\.(png|jpg|jgeg|git)$/,
        use: 'file-loader'
      },
      {
        test: /.(woff|woff2|eot|ttf|otf)$/,
        use: 'file-loader'
      }
    ]
  },
}
```
#### 更好的处理资源的 url-loader
使用 url-loader 更好的处理资源，设置较小的资源为 base64
``` js webpack.config.js
module.exports = {
 // some code ...
  module:{
    rules:[
      // somde code ...
      {
        test: /.(woff|woff2|eot|ttf|otf)$/,
        use: [{
          loadr:
        }]
      }
    ]
  },
}
```


